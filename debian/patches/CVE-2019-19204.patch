Origin: https://github.com/kkos/oniguruma/commit/6eb4aca6a7f2f60f473580576d86686ed6a6ebec
Author: K.Kosako <kosako@sofnec.co.jp>
Reviewed-by: Sylvain Beucler <beuc@debian.org>
Last-Update: 2019-12-02

From 6eb4aca6a7f2f60f473580576d86686ed6a6ebec Mon Sep 17 00:00:00 2001
From: "K.Kosako" <kosako@sofnec.co.jp>
Date: Wed, 6 Nov 2019 17:32:29 +0900
Subject: [PATCH] fix #162: heap-buffer-overflow in fetch_interval_quantifier
 due to double PFETCH

Index: libonig-5.9.5/regparse.c
===================================================================
--- libonig-5.9.5.orig/regparse.c
+++ libonig-5.9.5/regparse.c
@@ -2386,7 +2386,7 @@ fetch_range_quantifier(UChar** src, UCha
   if (PEND) goto invalid;
   PFETCH(c);
   if (IS_SYNTAX_OP(env->syntax, ONIG_SYN_OP_ESC_BRACE_INTERVAL)) {
-    if (c != MC_ESC(env->syntax)) goto invalid;
+    if (c != MC_ESC(env->syntax) || PEND) goto invalid;
     PFETCH(c);
   }
   if (c != '}') goto invalid;
