Origin: https://github.com/kkos/oniguruma/commit/d3e402928b6eb3327f8f7d59a9edfa622fec557b
Author: K.Kosako <kosako@sofnec.co.jp>
Reviewed-by: Sylvain Beucler <beuc@debian.org>
Last-Update: 2019-12-02

From d3e402928b6eb3327f8f7d59a9edfa622fec557b Mon Sep 17 00:00:00 2001
From: "K.Kosako" <kosako@sofnec.co.jp>
Date: Tue, 13 Aug 2019 13:37:30 +0900
Subject: [PATCH] fix heap-buffer-overflow

Index: libonig-5.9.5/regexec.c
===================================================================
--- libonig-5.9.5.orig/regexec.c
+++ libonig-5.9.5/regexec.c
@@ -2775,6 +2775,7 @@ str_lower_case_match(OnigEncoding enc, i
     lowlen = ONIGENC_MBC_CASE_FOLD(enc, case_fold_flag, &p, end, lowbuf);
     q = lowbuf;
     while (lowlen > 0) {
+      if (t >= tend)    return 0;
       if (*t++ != *q++)	return 0;
       lowlen--;
     }
